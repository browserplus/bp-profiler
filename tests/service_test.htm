<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>browser profiler test</title>
</head>
<body>
  <h2>browser profiler test</h2>

  current cpu usage of firefox: <div id="cpuUsage"> </div>

  current resident mem of firefox: <div id="residentMem"> </div>

</body>
<script class="javascript" src="http://bp.yahooapis.com/2.1.11/browserplus-min.js"></script>
</script>
<script>

function beginPoll() {
  setTimeout(function() {
    BrowserPlus.BrowserProfiler.GetUsage({},
      function(r) {
        if (r.success) {
          var d = document.getElementById("cpuUsage");
          d.innerHTML = r.value[0]; 
          d = document.getElementById("residentMem");
          d.innerHTML = r.value[1]; 
        }
        beginPoll();
      });
  }, 200);
}

function loadBP() 
{
  BrowserPlus.init({}, function(r) {
    if (r.success) {
      BrowserPlus.require({ services: [
        {service: "BrowserProfiler"}
      ] }, function(r) {
        if (!r.success) alert("couldn't require BrowserProfiler, did you install it?");
        else {
          beginPoll();
        } 
      });
    }
  });
}

if (window.addEventListener)
{
    window.addEventListener("load", loadBP, true);
}
else if (window.attachEvent)
{
    window.attachEvent("onload", loadBP);
}
</script>
</html>

